dirs:
    home: /home/iped
    P4Boosters: '{0.dirs.home}/dcomp/P4Boosters'
ssh:
    user: iped
    key: '~/.ssh/id_rsa_tofino'
    port: 22

init_cmds: {}

files: {}

hosts:
    client:
        addr: tclust1
        ip: 10.0.0.1
    server:
        addr: tclust2
        ip: 10.0.0.2
    tofino:
        addr: 158.130.4.218
        ssh:
            user: fpadmin
            key: '~/.ssh/id_rsa_tofino'
            port: 22


programs:
    log_dir: '{0.dirs.home}/logs/{0.label}'

    dataplane:
        host: tofino
        start: cd ~/gits/TofinoP4Boosters/simpleE2e && ./run.sh -d {0.args.drop_rate}
        stop: cd ~/gits/TofinoP4Boosters/simpleE2e && ./stop.sh

    moongen_tx:
        host: client
        start: cd ~/dcomp/MoonGen && ./build/MoonGen ./examples/l3-generator.lua  1 --out {log}
        stop: pkill --signal SIGINT MoonGen
        log:
            dir: moongen
            out: tx.out
            err: tx.err
            log: tx.csv

    moongen_rx:
        host: server
        start: cd ~/dcomp/MoonGen && ./build/MoonGen ./examples/l3-receiver.lua 1 --out {log}
        stop: pkill --signal SIGINT MoonGen
        log:
            dir: moongen
            out: rx.out
            err: rx.err
            log: rx.csv

commands:
    dataplane:
        begin: -10
        duration: 65
    moongen_tx:
        begin: 0
        duration: 55
        enforce_duration: True
    moongen_rx:
        begin: 20
        duration: 30
        enforce_duration: True
