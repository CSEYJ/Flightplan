#!/usr/bin/env bash
#Test setup for Flightplan
#Nik Sultana, UPenn, March 2020
#
# FIXME various hardcoded paths

TOPOLOGY=$WHARF_REPO/splits/ALV_split2/alv_k=4.yml
START_CFG=": $WHARF_REPO/splits/ALV_split2/start.sh"

MODES=(autotest)

if [ -z "${MODE}" ]
then
  MODE=autotest
  echo "Using default MODE from $0"
fi

function autotest {
  sudo -E python $WHARF_REPO/bmv2/start_flightplan_mininet.py ${TOPOLOGY} \
          --pcap-dump $PCAP_DUMPS \
          --log $LOG_DUMPS \
          --verbose \
          --showExitStatus \
     --fg-host-prog "${START_CFG}" \
     --fg-host-prog "p0h0: ping -c 1 192.0.0.2" \
     --fg-host-prog "p0h0: ping -c 1 192.0.0.3" \
     --fg-host-prog "p0h0: ping -c 1 192.0.1.2" \
     --fg-host-prog "p0h0: ping -c 1 192.0.1.3" \
     --fg-host-prog "p0h0: ping -c 1 192.1.0.2" \
     --fg-host-prog "p0h0: ping -c 1 192.1.0.3" \
     --fg-host-prog "p0h0: ping -c 1 192.1.1.2" \
     --fg-host-prog "p0h0: ping -c 1 192.1.1.3" \
     --fg-host-prog "p0h0: ping -c 1 192.2.0.2" \
     --fg-host-prog "p0h0: ping -c 1 192.2.0.3" \
     --fg-host-prog "p0h0: ping -c 1 192.2.1.2" \
     --fg-host-prog "p0h0: ping -c 1 192.2.1.3" \
     --fg-host-prog "p0h0: ping -c 1 192.3.0.2" \
     --fg-host-prog "p0h0: ping -c 1 192.3.0.3" \
     --fg-host-prog "p0h0: ping -c 1 192.3.1.2" \
     --fg-host-prog "p0h0: ping -c 1 192.3.1.3" \
     --fg-host-prog "p0h1: ping -c 1 192.0.0.2" \
     --fg-host-prog "p0h1: ping -c 1 192.0.0.3" \
     --fg-host-prog "p0h1: ping -c 1 192.0.1.2" \
     --fg-host-prog "p0h1: ping -c 1 192.0.1.3" \
     --fg-host-prog "p0h1: ping -c 1 192.1.0.2" \
     --fg-host-prog "p0h1: ping -c 1 192.1.0.3" \
     --fg-host-prog "p0h1: ping -c 1 192.1.1.2" \
     --fg-host-prog "p0h1: ping -c 1 192.1.1.3" \
     --fg-host-prog "p0h1: ping -c 1 192.2.0.2" \
     --fg-host-prog "p0h1: ping -c 1 192.2.0.3" \
     --fg-host-prog "p0h1: ping -c 1 192.2.1.2" \
     --fg-host-prog "p0h1: ping -c 1 192.2.1.3" \
     --fg-host-prog "p0h1: ping -c 1 192.3.0.2" \
     --fg-host-prog "p0h1: ping -c 1 192.3.0.3" \
     --fg-host-prog "p0h1: ping -c 1 192.3.1.2" \
     --fg-host-prog "p0h1: ping -c 1 192.3.1.3" \
     --fg-host-prog "p0h2: ping -c 1 192.0.0.2" \
     --fg-host-prog "p0h2: ping -c 1 192.0.0.3" \
     --fg-host-prog "p0h2: ping -c 1 192.0.1.2" \
     --fg-host-prog "p0h2: ping -c 1 192.0.1.3" \
     --fg-host-prog "p0h2: ping -c 1 192.1.0.2" \
     --fg-host-prog "p0h2: ping -c 1 192.1.0.3" \
     --fg-host-prog "p0h2: ping -c 1 192.1.1.2" \
     --fg-host-prog "p0h2: ping -c 1 192.1.1.3" \
     --fg-host-prog "p0h2: ping -c 1 192.2.0.2" \
     --fg-host-prog "p0h2: ping -c 1 192.2.0.3" \
     --fg-host-prog "p0h2: ping -c 1 192.2.1.2" \
     --fg-host-prog "p0h2: ping -c 1 192.2.1.3" \
     --fg-host-prog "p0h2: ping -c 1 192.3.0.2" \
     --fg-host-prog "p0h2: ping -c 1 192.3.0.3" \
     --fg-host-prog "p0h2: ping -c 1 192.3.1.2" \
     --fg-host-prog "p0h2: ping -c 1 192.3.1.3" \
     --fg-host-prog "p0h3: ping -c 1 192.0.0.2" \
     --fg-host-prog "p0h3: ping -c 1 192.0.0.3" \
     --fg-host-prog "p0h3: ping -c 1 192.0.1.2" \
     --fg-host-prog "p0h3: ping -c 1 192.0.1.3" \
     --fg-host-prog "p0h3: ping -c 1 192.1.0.2" \
     --fg-host-prog "p0h3: ping -c 1 192.1.0.3" \
     --fg-host-prog "p0h3: ping -c 1 192.1.1.2" \
     --fg-host-prog "p0h3: ping -c 1 192.1.1.3" \
     --fg-host-prog "p0h3: ping -c 1 192.2.0.2" \
     --fg-host-prog "p0h3: ping -c 1 192.2.0.3" \
     --fg-host-prog "p0h3: ping -c 1 192.2.1.2" \
     --fg-host-prog "p0h3: ping -c 1 192.2.1.3" \
     --fg-host-prog "p0h3: ping -c 1 192.3.0.2" \
     --fg-host-prog "p0h3: ping -c 1 192.3.0.3" \
     --fg-host-prog "p0h3: ping -c 1 192.3.1.2" \
     --fg-host-prog "p0h3: ping -c 1 192.3.1.3" \
     --fg-host-prog "p1h0: ping -c 1 192.0.0.2" \
     --fg-host-prog "p1h0: ping -c 1 192.0.0.3" \
     --fg-host-prog "p1h0: ping -c 1 192.0.1.2" \
     --fg-host-prog "p1h0: ping -c 1 192.0.1.3" \
     --fg-host-prog "p1h0: ping -c 1 192.1.0.2" \
     --fg-host-prog "p1h0: ping -c 1 192.1.0.3" \
     --fg-host-prog "p1h0: ping -c 1 192.1.1.2" \
     --fg-host-prog "p1h0: ping -c 1 192.1.1.3" \
     --fg-host-prog "p1h0: ping -c 1 192.2.0.2" \
     --fg-host-prog "p1h0: ping -c 1 192.2.0.3" \
     --fg-host-prog "p1h0: ping -c 1 192.2.1.2" \
     --fg-host-prog "p1h0: ping -c 1 192.2.1.3" \
     --fg-host-prog "p1h0: ping -c 1 192.3.0.2" \
     --fg-host-prog "p1h0: ping -c 1 192.3.0.3" \
     --fg-host-prog "p1h0: ping -c 1 192.3.1.2" \
     --fg-host-prog "p1h0: ping -c 1 192.3.1.3" \
     --fg-host-prog "p1h1: ping -c 1 192.0.0.2" \
     --fg-host-prog "p1h1: ping -c 1 192.0.0.3" \
     --fg-host-prog "p1h1: ping -c 1 192.0.1.2" \
     --fg-host-prog "p1h1: ping -c 1 192.0.1.3" \
     --fg-host-prog "p1h1: ping -c 1 192.1.0.2" \
     --fg-host-prog "p1h1: ping -c 1 192.1.0.3" \
     --fg-host-prog "p1h1: ping -c 1 192.1.1.2" \
     --fg-host-prog "p1h1: ping -c 1 192.1.1.3" \
     --fg-host-prog "p1h1: ping -c 1 192.2.0.2" \
     --fg-host-prog "p1h1: ping -c 1 192.2.0.3" \
     --fg-host-prog "p1h1: ping -c 1 192.2.1.2" \
     --fg-host-prog "p1h1: ping -c 1 192.2.1.3" \
     --fg-host-prog "p1h1: ping -c 1 192.3.0.2" \
     --fg-host-prog "p1h1: ping -c 1 192.3.0.3" \
     --fg-host-prog "p1h1: ping -c 1 192.3.1.2" \
     --fg-host-prog "p1h1: ping -c 1 192.3.1.3" \
     --fg-host-prog "p1h2: ping -c 1 192.0.0.2" \
     --fg-host-prog "p1h2: ping -c 1 192.0.0.3" \
     --fg-host-prog "p1h2: ping -c 1 192.0.1.2" \
     --fg-host-prog "p1h2: ping -c 1 192.0.1.3" \
     --fg-host-prog "p1h2: ping -c 1 192.1.0.2" \
     --fg-host-prog "p1h2: ping -c 1 192.1.0.3" \
     --fg-host-prog "p1h2: ping -c 1 192.1.1.2" \
     --fg-host-prog "p1h2: ping -c 1 192.1.1.3" \
     --fg-host-prog "p1h2: ping -c 1 192.2.0.2" \
     --fg-host-prog "p1h2: ping -c 1 192.2.0.3" \
     --fg-host-prog "p1h2: ping -c 1 192.2.1.2" \
     --fg-host-prog "p1h2: ping -c 1 192.2.1.3" \
     --fg-host-prog "p1h2: ping -c 1 192.3.0.2" \
     --fg-host-prog "p1h2: ping -c 1 192.3.0.3" \
     --fg-host-prog "p1h2: ping -c 1 192.3.1.2" \
     --fg-host-prog "p1h2: ping -c 1 192.3.1.3" \
     --fg-host-prog "p1h3: ping -c 1 192.0.0.2" \
     --fg-host-prog "p1h3: ping -c 1 192.0.0.3" \
     --fg-host-prog "p1h3: ping -c 1 192.0.1.2" \
     --fg-host-prog "p1h3: ping -c 1 192.0.1.3" \
     --fg-host-prog "p1h3: ping -c 1 192.1.0.2" \
     --fg-host-prog "p1h3: ping -c 1 192.1.0.3" \
     --fg-host-prog "p1h3: ping -c 1 192.1.1.2" \
     --fg-host-prog "p1h3: ping -c 1 192.1.1.3" \
     --fg-host-prog "p1h3: ping -c 1 192.2.0.2" \
     --fg-host-prog "p1h3: ping -c 1 192.2.0.3" \
     --fg-host-prog "p1h3: ping -c 1 192.2.1.2" \
     --fg-host-prog "p1h3: ping -c 1 192.2.1.3" \
     --fg-host-prog "p1h3: ping -c 1 192.3.0.2" \
     --fg-host-prog "p1h3: ping -c 1 192.3.0.3" \
     --fg-host-prog "p1h3: ping -c 1 192.3.1.2" \
     --fg-host-prog "p1h3: ping -c 1 192.3.1.3" \
     --fg-host-prog "p2h0: ping -c 1 192.0.0.2" \
     --fg-host-prog "p2h0: ping -c 1 192.0.0.3" \
     --fg-host-prog "p2h0: ping -c 1 192.0.1.2" \
     --fg-host-prog "p2h0: ping -c 1 192.0.1.3" \
     --fg-host-prog "p2h0: ping -c 1 192.1.0.2" \
     --fg-host-prog "p2h0: ping -c 1 192.1.0.3" \
     --fg-host-prog "p2h0: ping -c 1 192.1.1.2" \
     --fg-host-prog "p2h0: ping -c 1 192.1.1.3" \
     --fg-host-prog "p2h0: ping -c 1 192.2.0.2" \
     --fg-host-prog "p2h0: ping -c 1 192.2.0.3" \
     --fg-host-prog "p2h0: ping -c 1 192.2.1.2" \
     --fg-host-prog "p2h0: ping -c 1 192.2.1.3" \
     --fg-host-prog "p2h0: ping -c 1 192.3.0.2" \
     --fg-host-prog "p2h0: ping -c 1 192.3.0.3" \
     --fg-host-prog "p2h0: ping -c 1 192.3.1.2" \
     --fg-host-prog "p2h0: ping -c 1 192.3.1.3" \
     --fg-host-prog "p2h1: ping -c 1 192.0.0.2" \
     --fg-host-prog "p2h1: ping -c 1 192.0.0.3" \
     --fg-host-prog "p2h1: ping -c 1 192.0.1.2" \
     --fg-host-prog "p2h1: ping -c 1 192.0.1.3" \
     --fg-host-prog "p2h1: ping -c 1 192.1.0.2" \
     --fg-host-prog "p2h1: ping -c 1 192.1.0.3" \
     --fg-host-prog "p2h1: ping -c 1 192.1.1.2" \
     --fg-host-prog "p2h1: ping -c 1 192.1.1.3" \
     --fg-host-prog "p2h1: ping -c 1 192.2.0.2" \
     --fg-host-prog "p2h1: ping -c 1 192.2.0.3" \
     --fg-host-prog "p2h1: ping -c 1 192.2.1.2" \
     --fg-host-prog "p2h1: ping -c 1 192.2.1.3" \
     --fg-host-prog "p2h1: ping -c 1 192.3.0.2" \
     --fg-host-prog "p2h1: ping -c 1 192.3.0.3" \
     --fg-host-prog "p2h1: ping -c 1 192.3.1.2" \
     --fg-host-prog "p2h1: ping -c 1 192.3.1.3" \
     --fg-host-prog "p2h2: ping -c 1 192.0.0.2" \
     --fg-host-prog "p2h2: ping -c 1 192.0.0.3" \
     --fg-host-prog "p2h2: ping -c 1 192.0.1.2" \
     --fg-host-prog "p2h2: ping -c 1 192.0.1.3" \
     --fg-host-prog "p2h2: ping -c 1 192.1.0.2" \
     --fg-host-prog "p2h2: ping -c 1 192.1.0.3" \
     --fg-host-prog "p2h2: ping -c 1 192.1.1.2" \
     --fg-host-prog "p2h2: ping -c 1 192.1.1.3" \
     --fg-host-prog "p2h2: ping -c 1 192.2.0.2" \
     --fg-host-prog "p2h2: ping -c 1 192.2.0.3" \
     --fg-host-prog "p2h2: ping -c 1 192.2.1.2" \
     --fg-host-prog "p2h2: ping -c 1 192.2.1.3" \
     --fg-host-prog "p2h2: ping -c 1 192.3.0.2" \
     --fg-host-prog "p2h2: ping -c 1 192.3.0.3" \
     --fg-host-prog "p2h2: ping -c 1 192.3.1.2" \
     --fg-host-prog "p2h2: ping -c 1 192.3.1.3" \
     --fg-host-prog "p2h3: ping -c 1 192.0.0.2" \
     --fg-host-prog "p2h3: ping -c 1 192.0.0.3" \
     --fg-host-prog "p2h3: ping -c 1 192.0.1.2" \
     --fg-host-prog "p2h3: ping -c 1 192.0.1.3" \
     --fg-host-prog "p2h3: ping -c 1 192.1.0.2" \
     --fg-host-prog "p2h3: ping -c 1 192.1.0.3" \
     --fg-host-prog "p2h3: ping -c 1 192.1.1.2" \
     --fg-host-prog "p2h3: ping -c 1 192.1.1.3" \
     --fg-host-prog "p2h3: ping -c 1 192.2.0.2" \
     --fg-host-prog "p2h3: ping -c 1 192.2.0.3" \
     --fg-host-prog "p2h3: ping -c 1 192.2.1.2" \
     --fg-host-prog "p2h3: ping -c 1 192.2.1.3" \
     --fg-host-prog "p2h3: ping -c 1 192.3.0.2" \
     --fg-host-prog "p2h3: ping -c 1 192.3.0.3" \
     --fg-host-prog "p2h3: ping -c 1 192.3.1.2" \
     --fg-host-prog "p2h3: ping -c 1 192.3.1.3" \
     --fg-host-prog "p3h0: ping -c 1 192.0.0.2" \
     --fg-host-prog "p3h0: ping -c 1 192.0.0.3" \
     --fg-host-prog "p3h0: ping -c 1 192.0.1.2" \
     --fg-host-prog "p3h0: ping -c 1 192.0.1.3" \
     --fg-host-prog "p3h0: ping -c 1 192.1.0.2" \
     --fg-host-prog "p3h0: ping -c 1 192.1.0.3" \
     --fg-host-prog "p3h0: ping -c 1 192.1.1.2" \
     --fg-host-prog "p3h0: ping -c 1 192.1.1.3" \
     --fg-host-prog "p3h0: ping -c 1 192.2.0.2" \
     --fg-host-prog "p3h0: ping -c 1 192.2.0.3" \
     --fg-host-prog "p3h0: ping -c 1 192.2.1.2" \
     --fg-host-prog "p3h0: ping -c 1 192.2.1.3" \
     --fg-host-prog "p3h0: ping -c 1 192.3.0.2" \
     --fg-host-prog "p3h0: ping -c 1 192.3.0.3" \
     --fg-host-prog "p3h0: ping -c 1 192.3.1.2" \
     --fg-host-prog "p3h0: ping -c 1 192.3.1.3" \
     --fg-host-prog "p3h1: ping -c 1 192.0.0.2" \
     --fg-host-prog "p3h1: ping -c 1 192.0.0.3" \
     --fg-host-prog "p3h1: ping -c 1 192.0.1.2" \
     --fg-host-prog "p3h1: ping -c 1 192.0.1.3" \
     --fg-host-prog "p3h1: ping -c 1 192.1.0.2" \
     --fg-host-prog "p3h1: ping -c 1 192.1.0.3" \
     --fg-host-prog "p3h1: ping -c 1 192.1.1.2" \
     --fg-host-prog "p3h1: ping -c 1 192.1.1.3" \
     --fg-host-prog "p3h1: ping -c 1 192.2.0.2" \
     --fg-host-prog "p3h1: ping -c 1 192.2.0.3" \
     --fg-host-prog "p3h1: ping -c 1 192.2.1.2" \
     --fg-host-prog "p3h1: ping -c 1 192.2.1.3" \
     --fg-host-prog "p3h1: ping -c 1 192.3.0.2" \
     --fg-host-prog "p3h1: ping -c 1 192.3.0.3" \
     --fg-host-prog "p3h1: ping -c 1 192.3.1.2" \
     --fg-host-prog "p3h1: ping -c 1 192.3.1.3" \
     --fg-host-prog "p3h2: ping -c 1 192.0.0.2" \
     --fg-host-prog "p3h2: ping -c 1 192.0.0.3" \
     --fg-host-prog "p3h2: ping -c 1 192.0.1.2" \
     --fg-host-prog "p3h2: ping -c 1 192.0.1.3" \
     --fg-host-prog "p3h2: ping -c 1 192.1.0.2" \
     --fg-host-prog "p3h2: ping -c 1 192.1.0.3" \
     --fg-host-prog "p3h2: ping -c 1 192.1.1.2" \
     --fg-host-prog "p3h2: ping -c 1 192.1.1.3" \
     --fg-host-prog "p3h2: ping -c 1 192.2.0.2" \
     --fg-host-prog "p3h2: ping -c 1 192.2.0.3" \
     --fg-host-prog "p3h2: ping -c 1 192.2.1.2" \
     --fg-host-prog "p3h2: ping -c 1 192.2.1.3" \
     --fg-host-prog "p3h2: ping -c 1 192.3.0.2" \
     --fg-host-prog "p3h2: ping -c 1 192.3.0.3" \
     --fg-host-prog "p3h2: ping -c 1 192.3.1.2" \
     --fg-host-prog "p3h2: ping -c 1 192.3.1.3" \
     --fg-host-prog "p3h3: ping -c 1 192.0.0.2" \
     --fg-host-prog "p3h3: ping -c 1 192.0.0.3" \
     --fg-host-prog "p3h3: ping -c 1 192.0.1.2" \
     --fg-host-prog "p3h3: ping -c 1 192.0.1.3" \
     --fg-host-prog "p3h3: ping -c 1 192.1.0.2" \
     --fg-host-prog "p3h3: ping -c 1 192.1.0.3" \
     --fg-host-prog "p3h3: ping -c 1 192.1.1.2" \
     --fg-host-prog "p3h3: ping -c 1 192.1.1.3" \
     --fg-host-prog "p3h3: ping -c 1 192.2.0.2" \
     --fg-host-prog "p3h3: ping -c 1 192.2.0.3" \
     --fg-host-prog "p3h3: ping -c 1 192.2.1.2" \
     --fg-host-prog "p3h3: ping -c 1 192.2.1.3" \
     --fg-host-prog "p3h3: ping -c 1 192.3.0.2" \
     --fg-host-prog "p3h3: ping -c 1 192.3.0.3" \
     --fg-host-prog "p3h3: ping -c 1 192.3.1.2" \
     --fg-host-prog "p3h3: ping -c 1 192.3.1.3" \
          2> $LOG_DUMPS/flightplan_mininet_log.err
}

source `dirname "$0"`/../../run_alv.sh
